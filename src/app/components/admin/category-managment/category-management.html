<div class="category-management-container">
    <header class="management-header">
        <h2>Category Management</h2>
        <button class="btn btn-primary" (click)="toggleAddCategoryPanel()">
            <span class="icon">+</span> Add New Category
        </button>
    </header>

    <div class="category-list-section">
        @if (productListService._CategoriesApiStatus() === 'loading') {
        <div class="loading-state">Loading categories...</div>
        } @else if (productListService._CategoriesApiStatus() === 'error') {
        <div class="error-state">Failed to load categories.</div>
        } @else {
        <table class="category-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @for (category of productListService._Categories(); track category.id) {
                <tr>
                    <td>{{ category.id }}</td>
                    <td>{{ category.name }}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-icon btn-edit" title="Edit Category">‚úèÔ∏è</button>
                            <button class="btn btn-icon btn-delete" title="Delete Category">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
                } @empty {
                <tr>
                    <td colspan="3" class="empty-state">No categories found.</td>
                </tr>
                }
            </tbody>
        </table>
        }
    </div>
</div>

@if (showAddCategoryPanel()) {
<app-overlay-panel [isVisible]="showAddCategoryPanel()" title="Add Category" (close)="toggleAddCategoryPanel()">
    <form [formGroup]="addCategoryForm" (ngSubmit)="onAddCategory()">
        <div class="form-group">
            <label for="categoryName">Category Name</label>
            <input id="categoryName" type="text" formControlName="name" class="form-control"
                placeholder="e.g. Electronics" [class.is-invalid]="
                addCategoryForm.get('name')?.invalid && addCategoryForm.get('name')?.touched
              " />
            @if (addCategoryForm.get('name')?.invalid && addCategoryForm.get('name')?.touched) {
            <span class="error-message">Category name is required.</span>
            }
        </div>
        <div class="form-actions">
            <button type="button" class="btn btn-secondary" (click)="toggleAddCategoryPanel()">
                Cancel
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="addCategoryForm.invalid">
                Add Category
            </button>
        </div>
    </form>
</app-overlay-panel>
}